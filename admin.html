<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KALYAN VIP MASTER ADMIN</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <style>
        body { background: #0b0b0b; color: #fff; font-family: sans-serif; margin: 0; padding-bottom: 50px; }
        .header { background: #1a1a1a; padding: 15px; text-align: center; border-bottom: 2px solid gold; color: gold; font-weight: bold; }
        .nav-tabs { display: flex; background: #151515; padding: 10px; gap: 10px; overflow-x: auto; position: sticky; top: 0; z-index: 100; }
        .tab-btn { background: #333; color: #fff; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; white-space: nowrap; }
        .tab-btn.active { background: gold; color: #000; font-weight: bold; }
        .section { display: none; padding: 15px; }
        .active { display: block; }
        .card { background: #1a1a1a; border-radius: 12px; border: 1px solid #333; padding: 15px; margin-bottom: 15px; }
        h3 { color: gold; margin-top: 0; font-size: 16px; border-left: 4px solid gold; padding-left: 10px; }
        input { width: 94%; padding: 12px; margin: 10px 0; background: #222; color: #fff; border: 1px solid #444; border-radius: 8px; }
        .btn { width: 100%; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .btn-green { background: #2ecc71; color: #fff; }
        .btn-red { background: #e74c3c; color: #fff; }
        .game-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        .g-btn { padding: 12px; background: #222; color: #fff; border: 1px solid #444; border-radius: 8px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<div class="header">KALYAN VIP MASTER ADMIN</div>

<div class="nav-tabs">
    <button class="tab-btn active" onclick="showTab(event, 'games')">üéÆ GAMES</button>
    <button class="tab-btn" onclick="showTab(event, 'wallet')">üí∞ WALLET</button>
    <button class="tab-btn" onclick="showTab(event, 'requests')">üì© REQUESTS</button>
    <button class="tab-btn" onclick="showTab(event, 'settings')">‚öôÔ∏è DASHBOARD</button>
</div>

<div id="games" class="section active">
    <div class="card">
        <h3>üêØ Dragon Tiger (game.html)</h3>
        <div class="game-grid">
            <button class="g-btn" style="color:red;" onclick="sendGame('dvt', 'dragon')">DRAGON</button>
            <button class="g-btn" style="color:gold;" onclick="sendGame('dvt', 'tie')">TIE</button>
            <button class="g-btn" style="color:skyblue;" onclick="sendGame('dvt', 'tiger')">TIGER</button>
            <button class="g-btn" style="grid-column: span 3; color: #0f0;" onclick="sendGame('dvt', 'auto')">AUTO PROFIT</button>
        </div>
    </div>
    <div class="card">
        <h3>üÉè Andar Bahar (andarbahar.html)</h3>
        <div class="game-grid">
            <button class="g-btn" style="color:red; grid-column: span 1.5;" onclick="sendGame('ab', 'andar')">ANDAR</button>
            <button class="g-btn" style="color:skyblue; grid-column: span 1.5;" onclick="sendGame('ab', 'bahar')">BAHAR</button>
            <button class="g-btn" style="grid-column: span 3; color: #0f0;" onclick="sendGame('ab', 'auto')">AUTO PROFIT</button>
        </div>
    </div>
</div>

<div id="wallet" class="section">
    <div class="card">
        <h3>üíµ Balance Manager</h3>
        <input type="text" id="targetPh" placeholder="Player Phone Number">
        <input type="number" id="targetAmt" placeholder="Amount (‚Çπ)">
        <button class="btn btn-green" onclick="updateBal('add')">ADD BALANCE</button>
        <button class="btn btn-red" onclick="updateBal('cut')">CUT BALANCE</button>
    </div>
</div>

<div id="requests" class="section">
    <div class="card">
        <h3>üì© Deposit & Withdrawal Requests</h3>
        <div id="req-data">Loading requests...</div>
    </div>
</div>

<div id="settings" class="section">
    <div class="card">
        <h3>üè¶ Dashboard Social & Payments</h3>
        <input type="text" id="upiId" placeholder="UPI ID">
        <input type="text" id="qrImg" placeholder="QR Image URL">
        <input type="text" id="waNo" placeholder="WhatsApp Number">
        <input type="text" id="tgLink" placeholder="Telegram Link">
        <button class="btn btn-green" onclick="saveDashboard()">SAVE DASHBOARD SETTINGS</button>
    </div>
    <div class="card">
        <h3>üì¢ Notice Board</h3>
        <input type="text" id="notifText" placeholder="Enter marquee message...">
        <button class="btn btn-green" onclick="saveNotice()">UPDATE NOTICE</button>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyCy2zsDDJeVTQEbHCenkLIlz3lWWyo-Pqo",
        databaseURL: "https://kalyan-casino-default-rtdb.firebaseio.com",
        projectId: "kalyan-casino"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function showTab(e, id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        e.currentTarget.classList.add('active');
    }

    // ‚úÖ Game Result Control
    function sendGame(game, res) {
        const mode = (res === 'auto') ? 'auto' : 'manual';
        db.ref('game_settings/' + game).update({ mode: mode, result: res });
        alert(game.toUpperCase() + " Set to: " + res.toUpperCase());
    }

    // ‚úÖ Wallet Control (Standard Path)
    function updateBal(type) {
        const ph = document.getElementById('targetPh').value;
        const amt = parseFloat(document.getElementById('targetAmt').value);
        if(!ph || !amt) return alert("Phone aur Amount bhariye!");
        
        db.ref('users/' + ph + '/balance').transaction(b => {
            return type === 'add' ? (parseFloat(b) || 0) + amt : (parseFloat(b) || 0) - amt;
        }).then(() => alert("Wallet Updated!"));
    }

    // ‚úÖ Dashboard & Notice
    function saveDashboard() {
        db.ref('admin_settings').update({
            upi: document.getElementById('upiId').value,
            qr: document.getElementById('qrImg').value,
            whatsapp: document.getElementById('waNo').value,
            telegram: document.getElementById('tgLink').value
        }).then(() => alert("Dashboard Updated!"));
    }

    function saveNotice() {
        db.ref('admin_settings/notification').set(document.getElementById('notifText').value)
        .then(() => alert("Notice Updated!"));
    }

    // ‚úÖ Request Monitor
    db.ref('requests').on('value', snap => {
        let html = "";
        snap.forEach(child => {
            let r = child.val();
            html += `<div style="background:#222; padding:10px; border-radius:8px; margin-bottom:10px; border-left:4px solid gold;">
                <b>${r.phone}</b> | ${r.type} | ‚Çπ${r.amount}
                <button onclick="approveReq('${child.key}','${r.phone}',${r.amount},'${r.type}')" style="float:right; background:gold; border:none; border-radius:4px; padding:5px 10px; font-weight:bold;">APPROVE</button>
            </div>`;
        });
        document.getElementById('req-data').innerHTML = html || "No pending requests.";
    });

    function approveReq(id, ph, amt, type) {
        if(type === 'Deposit') {
            db.ref('users/'+ph+'/balance').transaction(b => (parseFloat(b)||0)+amt);
        }
        db.ref('requests/'+id).remove();
        alert("Request Approved!");
    }
</script>
</body>
</html>
