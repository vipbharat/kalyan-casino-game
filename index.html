<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalyan Pro - Login/Signup</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; padding: 30px 15px; }
        .logo { font-size: 32px; font-weight: bold; color: gold; margin-bottom: 20px; }
        .form-box { background: #1a1a1a; padding: 25px; border-radius: 15px; border: 1px solid #333; }
        input { width: 90%; padding: 12px; margin: 10px 0; background: #222; border: 1px solid #444; color: #fff; border-radius: 8px; font-size: 16px; }
        .btn { background: gold; color: #000; padding: 15px; width: 100%; border: none; border-radius: 8px; font-weight: bold; font-size: 18px; cursor: pointer; margin-top: 15px; }
        .bonus-tag { color: #0f0; font-size: 14px; font-weight: bold; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div class="logo">KALYAN <span style="color:white;">PRO</span></div>
    
    <div class="form-box">
        <div class="bonus-tag">üéÅ SIGNUP BONUS: ‚Çπ51 FREE</div>
        
        <input type="tel" id="phone" placeholder="Mobile Number" maxlength="10">
        <input type="password" id="pass" placeholder="Create Password">
        <input type="text" id="refCode" placeholder="Referral Code (Optional)">
        
        <button class="btn" onclick="handleSignup()">REGISTER & PLAY</button>
        <p style="font-size: 12px; color: #888; margin-top: 15px;">Already have an account? <a href="#" style="color: gold;">Login</a></p>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCy2zsDDJeVTQEbHCenkLIlz3lWWyo-Pqo",
            authDomain: "kalyan-casino.firebaseapp.com",
            databaseURL: "https://kalyan-casino-default-rtdb.firebaseio.com",
            projectId: "kalyan-casino",
            storageBucket: "kalyan-casino.firebasestorage.app",
            messagingSenderId: "805675620545",
            appId: "1:805675620545:web:6b49c99f325432a8249c40"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function handleSignup() {
            const phone = document.getElementById('phone').value.trim();
            const pass = document.getElementById('pass').value.trim();
            const refCode = document.getElementById('refCode').value.trim() || "NONE";

            if(phone.length < 10 || pass.length < 4) {
                alert("Sahi details bharein!");
                return;
            }

            // Check if user already exists
            db.ref('users/' + phone).once('value', (snap) => {
                if(snap.exists()) {
                    alert("Aap pehle se registered hain! Seedha login karein.");
                } else {
                    // Create New User with ‚Çπ51 Bonus
                    db.ref('users/' + phone).set({
                        password: pass,
                        balance: 51,
                        referredBy: refCode,
                        referral_count: 0,
                        referral_earnings: 0,
                        isFirstRechargeDone: false,
                        joinedAt: Date.now()
                    }).then(() => {
                        localStorage.setItem('userPhone', phone);
                        alert("Signup Success! ‚Çπ51 Bonus Credit ho gaya.");
                        window.location.href = "dashboard.html";
                    });
                }
            });
        }
    </script>
</body>
</html>
