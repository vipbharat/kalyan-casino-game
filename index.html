<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Dragon Tiger</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .box { width: 300px; padding: 25px; background: #111; border: 2px solid #ffd700; border-radius: 15px; text-align: center; box-shadow: 0 0 15px rgba(255,215,0,0.2); }
        h2 { color: #ffd700; margin-bottom: 20px; font-size: 24px; }
        input { width: 90%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #333; background: #222; color: #fff; text-align: center; font-size: 16px; outline: none; }
        button { width: 100%; padding: 12px; background: #ffd700; border: none; font-weight: bold; border-radius: 8px; cursor: pointer; margin-top: 10px; font-size: 16px; transition: 0.3s; }
        button:active { transform: scale(0.95); }
        .toggle { font-size: 13px; color: #aaa; margin-top: 20px; cursor: pointer; text-decoration: underline; }
    </style>
</head>
<body>

<div class="box" id="reg-box">
    <h2>REGISTER</h2>
    <input type="number" id="r-phone" placeholder="Mobile Number">
    <input type="password" id="r-pass" placeholder="Password">
    <input type="password" id="r-conf" placeholder="Confirm Password">
    <button onclick="handleRegister()">CREATE ACCOUNT</button>
    <div class="toggle" onclick="showLogin(true)">Already have account? Login</div>
</div>

<div class="box" id="login-box" style="display:none">
    <h2>LOGIN</h2>
    <input type="number" id="l-phone" placeholder="Mobile Number">
    <input type="password" id="l-pass" placeholder="Password">
    <button onclick="handleLogin()">ENTER DASHBOARD</button>
    <div class="toggle" onclick="showLogin(false)">New here? Create Account</div>
</div>

<script>
    // --- AAPKA FIREBASE CONFIG YAHAN HAI ---
    const firebaseConfig = { 
        apiKey: "AIzaSyCy2zsDDJeVTQEbHCenkLIlz3lWWyo-Pqo",
        databaseURL: "https://kalyan-casino-default-rtdb.firebaseio.com",
        projectId: "kalyan-casino"
    };
    
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Toggle between Login & Register
    function showLogin(show) {
        document.getElementById('reg-box').style.display = show ? 'none' : 'block';
        document.getElementById('login-box').style.display = show ? 'block' : 'none';
    }

    // Register Function (Check Duplicate)
    function handleRegister() {
        const ph = document.getElementById('r-phone').value;
        const ps = document.getElementById('r-pass').value;
        const cf = document.getElementById('r-conf').value;

        if(ph.length < 10) { alert("Sahi mobile number daalein!"); return; }
        if(ps !== cf || ps === "") { alert("Password match nahi ho raha!"); return; }

        db.ref('users/' + ph).once('value', s => {
            if(s.exists()) { 
                alert("❌ Yeh number pehle se registered hai! Login karein."); 
            }
            else {
                const gameID = "DT-" + Math.floor(100000 + Math.random() * 900000);
                db.ref('users/' + ph).set({ 
                    phone: ph, 
                    pass: ps, 
                    id: gameID, 
                    wallet: 0,
                    date: new Date().toLocaleDateString()
                }).then(() => {
                    alert("✅ Registration Successful!\nAapki ID: " + gameID);
                    loginDone(ph);
                });
            }
        });
    }

    // Login Function
    function handleLogin() {
        const ph = document.getElementById('l-phone').value;
        const ps = document.getElementById('l-pass').value;

        if(!ph || !ps) { alert("Details bhariye!"); return; }

        db.ref('users/' + ph).once('value', s => {
            if(s.exists() && s.val().pass === ps) { 
                loginDone(ph); 
            }
            else { 
                alert("❌ Galat Details!"); 
            }
        });
    }

    // Store Session & Redirect
    function loginDone(ph) {
        localStorage.setItem('userPhone', ph);
        window.location.href = "dashboard.html"; 
    }
</script>
</body>
</html>
