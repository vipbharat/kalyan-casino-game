<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP Casino</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; text-align: center; margin: 0; padding-top: 50px; }
        .box { background: #111; padding: 20px; border-radius: 15px; width: 300px; margin: auto; border: 1px solid #333; }
        input { width: 90%; padding: 12px; margin: 10px 0; background: #222; border: 1px solid #444; color: #fff; border-radius: 8px; }
        button { width: 90%; padding: 12px; background: #ffd700; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: #000; }
        button:disabled { background: #555; }
        .hidden { display: none; }
        #otp-box { border: 2px dashed #ffd700; padding: 10px; margin: 10px 0; color: #ffd700; font-size: 20px; }
    </style>
</head>
<body>

<div class="box">
    <h2 id="title">REGISTER</h2>
    
    <div id="reg-form">
        <input type="number" id="phone" placeholder="Mobile Number">
        
        <div id="extra" class="hidden">
            <div id="otp-box">OTP: <span id="val">000000</span></div>
            <input type="number" id="otp-in" placeholder="Enter OTP">
            <input type="password" id="p1" placeholder="Create Password">
            <input type="password" id="p2" placeholder="Confirm Password">
        </div>

        <div id="msg" style="color: #0f0; margin: 10px 0;"></div>
        <button id="btn" onclick="startProcess()">SEND OTP</button>
    </div>
    
    <p onclick="location.reload()" style="font-size: 12px; color: #888; margin-top: 15px; cursor: pointer;">Puraane Account ke liye Refresh karein</p>
</div>

<script>
    // Firebase simple connection
    var config = { 
        apiKey: "AIzaSyCy2zsDDJeVTQEbHCenkLIlz3lWWyo-Pqo", 
        databaseURL: "https://kalyan-casino-default-rtdb.firebaseio.com" 
    };
    if (!firebase.apps.length) { firebase.initializeApp(config); }
    var db = firebase.database();

    var otpCode = "";

    function startProcess() {
        var ph = document.getElementById('phone').value;
        if(ph.length < 10) return alert("10 anko ka number dalo!");

        var btn = document.getElementById('btn');
        var msg = document.getElementById('msg');
        
        btn.disabled = true;
        var sec = 10;

        // Timer shuru
        var timer = setInterval(function() {
            msg.innerText = "⏳ OTP generating in: " + sec + "s";
            sec--;
            if(sec < 0) {
                clearInterval(timer);
                msg.innerText = "✅ OTP Ready!";
                
                // OTP generate karo
                otpCode = Math.floor(100000 + Math.random() * 899999).toString();
                document.getElementById('val').innerText = otpCode;
                document.getElementById('extra').classList.remove('hidden');
                
                btn.disabled = false;
                btn.innerText = "VERIFY & REGISTER";
                btn.onclick = finalRegister;
            }
        }, 1000);
    }

    function finalRegister() {
        var ph = document.getElementById('phone').value;
        var oIn = document.getElementById('otp-in').value;
        var pass = document.getElementById('p1').value;
        var pass2 = document.getElementById('p2').value;

        if(oIn !== otpCode) return alert("Galat OTP!");
        if(pass !== pass2 || pass === "") return alert("Password match nahi hua!");

        var vipID = "VIP" + Math.floor(100000 + Math.random() * 899999);

        // Database mein save
        db.ref('users/' + ph).set({
            phone: ph, password: pass, balance: 51, uid: vipID
        }).then(function() {
            localStorage.setItem('userPhone', ph);
            window.location.href = "dashboard.html";
        }).catch(function(e) {
            alert("Database Error: Rules check karein!");
        });
    }
</script>
</body>
</html>
